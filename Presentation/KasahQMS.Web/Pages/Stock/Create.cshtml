@page
@model KasahQMS.Web.Pages.Stock.CreateModel
@{
    ViewData["Title"] = "Add Stock Item";
}

<div class="space-y-6 animate-fade-in max-w-4xl mx-auto">
    <!-- Page Header -->
    <div class="flex items-start gap-4">
        <a href="/Stock" class="mt-1 p-2 rounded-lg bg-white border border-slate-200 text-slate-500 hover:bg-slate-50 hover:text-brand-600 transition-all">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
            </svg>
        </a>
        <div>
            <h1 class="text-2xl lg:text-3xl font-bold text-slate-900 tracking-tight">Add Stock Item</h1>
            <p class="mt-1 text-slate-500">Create a new product or service in your inventory catalog</p>
        </div>
    </div>

    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <div class="p-4 rounded-xl bg-red-50 border border-red-200">
            <div class="flex items-center gap-3">
                <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                </svg>
                <p class="text-sm text-red-700">@Model.ErrorMessage</p>
            </div>
        </div>
    }

    @if (!Model.CanManageStock)
    {
        <div class="card p-6 border-amber-200 bg-amber-50">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center">
                    <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                    </svg>
                </div>
                <div>
                    <h3 class="font-semibold text-amber-800">Access Restricted</h3>
                    <p class="text-sm text-amber-700">Only TMD, Deputy, and Tender roles can create stock items.</p>
                </div>
            </div>
        </div>
    }
    else
    {
        <form method="post" class="space-y-6">
            @Html.AntiForgeryToken()

            <!-- Basic Information -->
            <div class="card p-6">
                <h2 class="text-lg font-semibold text-slate-900 mb-4">Basic Information</h2>
                <div class="grid gap-6 md:grid-cols-2">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            SKU <span class="text-red-500">*</span>
                        </label>
                        <input type="text" asp-for="SKU" 
                               class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500"
                               placeholder="e.g., PROD-001">
                        <span asp-validation-for="SKU" class="text-sm text-red-600"></span>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            Name <span class="text-red-500">*</span>
                        </label>
                        <input type="text" asp-for="Name" 
                               class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500"
                               placeholder="Product or service name">
                        <span asp-validation-for="Name" class="text-sm text-red-600"></span>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-slate-700 mb-1">Description</label>
                        <textarea asp-for="Description" rows="3"
                                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500"
                                  placeholder="Optional description..."></textarea>
                        <span asp-validation-for="Description" class="text-sm text-red-600"></span>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            Category <span class="text-red-500">*</span>
                        </label>
                        <select asp-for="Category" 
                                class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500">
                            <option value="Product">Product</option>
                            <option value="Service">Service</option>
                            <option value="RawMaterial">Raw Material</option>
                            <option value="FinishedGoods">Finished Goods</option>
                            <option value="Consumable">Consumable</option>
                            <option value="Equipment">Equipment</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            Unit of Measure <span class="text-red-500">*</span>
                        </label>
                        <input type="text" asp-for="UnitOfMeasure" 
                               class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500"
                               placeholder="e.g., PCS, KG, L, Hours">
                        <span asp-validation-for="UnitOfMeasure" class="text-sm text-red-600"></span>
                    </div>
                </div>
            </div>

            <!-- Pricing -->
            <div class="card p-6">
                <h2 class="text-lg font-semibold text-slate-900 mb-4">Pricing</h2>
                <div class="grid gap-6 md:grid-cols-2">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            Unit Cost (RWF) <span class="text-red-500">*</span>
                        </label>
                        <input type="number" asp-for="UnitCost" step="0.01" min="0"
                               class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500"
                               placeholder="0.00">
                        <span asp-validation-for="UnitCost" class="text-sm text-red-600"></span>
                        <p class="text-xs text-slate-500 mt-1">Cost price for valuation</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">
                            Unit Price (RWF) <span class="text-red-500">*</span>
                        </label>
                        <input type="number" asp-for="UnitPrice" step="0.01" min="0"
                               class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500"
                               placeholder="0.00">
                        <span asp-validation-for="UnitPrice" class="text-sm text-red-600"></span>
                        <p class="text-xs text-slate-500 mt-1">Selling price for tenders</p>
                    </div>
                </div>
            </div>

            <!-- Stock Settings -->
            <div class="card p-6">
                <h2 class="text-lg font-semibold text-slate-900 mb-4">Stock Settings</h2>
                <div class="space-y-4">
                    <div class="flex items-center gap-3">
                        <input type="checkbox" asp-for="IsService" id="IsService"
                               class="w-4 h-4 text-brand-600 border-slate-300 rounded focus:ring-brand-500">
                        <label for="IsService" class="text-sm text-slate-700">
                            This is a service (non-physical item)
                        </label>
                    </div>
                    <div class="flex items-center gap-3">
                        <input type="checkbox" asp-for="TrackInventory" id="TrackInventory" checked
                               class="w-4 h-4 text-brand-600 border-slate-300 rounded focus:ring-brand-500">
                        <label for="TrackInventory" class="text-sm text-slate-700">
                            Track inventory levels for this item
                        </label>
                    </div>
                </div>

                <div class="mt-6 grid gap-6 md:grid-cols-2">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Minimum Stock Level</label>
                        <input type="number" asp-for="MinimumStockLevel" step="0.01" min="0"
                               class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500"
                               placeholder="0">
                        <p class="text-xs text-slate-500 mt-1">Alert when stock falls below this level</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Reorder Point</label>
                        <input type="number" asp-for="ReorderPoint" step="0.01" min="0"
                               class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500"
                               placeholder="0">
                        <p class="text-xs text-slate-500 mt-1">Trigger reorder alert at this level</p>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="flex items-center justify-end gap-3">
                <a href="/Stock" class="px-4 py-2 text-slate-700 font-medium hover:text-slate-900 transition-colors">
                    Cancel
                </a>
                <button type="submit"
                        class="px-6 py-2.5 bg-gradient-to-r from-brand-600 to-brand-700 text-white font-semibold rounded-xl hover:from-brand-700 hover:to-brand-800 transition-all shadow-lg shadow-brand-500/25">
                    Create Stock Item
                </button>
            </div>
        </form>
    }
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
